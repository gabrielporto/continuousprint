
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Scripting - Continuous Print</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../style.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scripting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Continuous Print" class="md-header__button md-logo" aria-label="Continuous Print" data-md-component="logo">
      
  <img src="../CPQ_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Continuous Print
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Scripting
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Continuous Print" class="md-nav__button md-logo" aria-label="Continuous Print" data-md-component="logo">
      
  <img src="../CPQ_white.svg" alt="logo">

    </a>
    Continuous Print
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Scripting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Scripting
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    Events
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scripts" class="md-nav__link">
    Scripts
  </a>
  
    <nav class="md-nav" aria-label="Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load-defaults" class="md-nav__link">
    Load Defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-scripts" class="md-nav__link">
    Custom Scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-use-bedready-to-check-bed-state" class="md-nav__link">
    Optional: Use BedReady to check bed state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocessors" class="md-nav__link">
    Preprocessors
  </a>
  
    <nav class="md-nav" aria-label="Preprocessors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#language" class="md-nav__link">
    Language
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notifications" class="md-nav__link">
    Notifications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-state" class="md-nav__link">
    Available State
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-carryover" class="md-nav__link">
    State Carryover
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-state" class="md-nav__link">
    External State
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    Contributing
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../advanced-queuing/" class="md-nav__link">
        Queuing Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../job-files/" class="md-nav__link">
        Job Files
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../failure-recovery/" class="md-nav__link">
        Failure Recovery
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../lan-queues/" class="md-nav__link">
        LAN Queues
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../material-selection/" class="md-nav__link">
        Material Selection
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../printer-profiles/" class="md-nav__link">
        Printer Profiles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../managed-bed-cooldown/" class="md-nav__link">
        Managed Bed Cooldown
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../action-commands/" class="md-nav__link">
        Action Commands
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        API
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    Events
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scripts" class="md-nav__link">
    Scripts
  </a>
  
    <nav class="md-nav" aria-label="Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load-defaults" class="md-nav__link">
    Load Defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-scripts" class="md-nav__link">
    Custom Scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-use-bedready-to-check-bed-state" class="md-nav__link">
    Optional: Use BedReady to check bed state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocessors" class="md-nav__link">
    Preprocessors
  </a>
  
    <nav class="md-nav" aria-label="Preprocessors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#language" class="md-nav__link">
    Language
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value" class="md-nav__link">
    Return Value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notifications" class="md-nav__link">
    Notifications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-state" class="md-nav__link">
    Available State
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-carryover" class="md-nav__link">
    State Carryover
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-state" class="md-nav__link">
    External State
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    Contributing
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="scripting">Scripting</h1>
<p><strong>Control what happens in between queued prints by using Events to run Scripts</strong>.</p>
<h2 id="events">Events</h2>
<p>Events fire at certain points when the queue is being run - when a print completes, for instance. You can see the full list of events by going to <code>Settings &gt; Continuous Print &gt; Events</code> or <a href="https://github.com/smartin015/continuousprint/blob/master/continuousprint/data/__init__.py">looking here in the source code</a>.</p>
<p>When an event fires, you can run one or more configured scripts. These events are also visible to other OctoPrint plugins (e.g. <a href="https://plugins.octoprint.org/plugins/IFTTT/">OctoPrint-IFTTT</a>) and can be used to perform actions in them.</p>
<h2 id="scripts">Scripts</h2>
<p>Event scripts, just like 3D print files, are in GCODE. Each script is a series of commands that are sent to the printer that tell it to move, heat up, cool down, etc.</p>
<p>GCODE scripts can be quite complex - it's recommended to load default scripts if you're just getting started, or as examples to modify. If you want to learn to make your own scripts, try reading through <a href="https://www.simplify3d.com/support/articles/3d-printing-gcode-tutorial/">this primer</a>.</p>
<h3 id="load-defaults">Load Defaults</h3>
<p>If your 3D printer is common, you should first check the user-contributed default scripts for your printer.</p>
<p>To load default scripts:</p>
<ol>
<li>Navigate to <code>Settings &gt; Continuous Print &gt; Profile</code> and ensure the make and model of your 3D printer is correct.</li>
<li>Click on the <code>Scripts</code> tab, then click <code>Load from Profile</code>. You should see two new scripts ("Bed Clearing" and "Finished") appear matching your printer make and model.</li>
<li>Click on the <code>Events</code> tab and scroll down to <code>Print Success</code>.</li>
<li>Replace the Bed Clearing script there with the new one.</li>
<li>Scroll down to <code>Queue Finished</code> and replace its script with the new script.</li>
<li>Click <code>Save</code>.</li>
</ol>
<p>If you want to contribute a change or a new default script, read the <a href="#contributing">Contributing</a> section below. You can browse through all the scripts <a href="https://github.com/smartin015/continuousprint/blob/master/continuousprint/data/gcode_scripts.yaml">here</a>.</p>
<h3 id="custom-scripts">Custom Scripts</h3>
<p>You can also set up your own custom scripts to run when events happen.</p>
<p>To add a new custom script:</p>
<ol>
<li>Navigate to <code>Settings &gt; Continuous Print &gt; Scripts</code>, then click <code>New Script</code>. A new (unnamed) script will appear in the list.</li>
<li>Put your GCODE script in the large text box - as an example, try typing in <code>@pause</code> to pause the print and wait for you to resume it.</li>
<li>Give the script a name (e.g. "Example Script"), then click the Done button at the bottom of the edit area.</li>
</ol>
<p>Your script is now created, but it will not run until we assign it to one or more events.</p>
<p>To register the script to an event:</p>
<ol>
<li>Click the <code>Events</code> tab and scroll to the desired event. For example, <code>Queue Deactivated</code> which runs when you click the <code>Stop Managing</code> button.</li>
<li>Click the <code>Add Script</code> button, then the name of your script. You should now see it listed below the event name.</li>
<li>Click <code>Save</code> to save your settings.</li>
</ol>
<p>Now try it out! Whenever your event fires, it should run this new script.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can use the same script for multiple events, e.g. run bed clearing after each print <em>and</em> when the last print is finished.</p>
<p>You can also run multiple scripts in the same event - they are executed from top to bottom, and you can drag to reorder them.</p>
</div>
<h3 id="optional-use-bedready-to-check-bed-state">Optional: Use BedReady to check bed state</h3>
<p><a href="https://plugins.octoprint.org/plugins/bedready/">OctoPrint-BedReady</a> is a plugin that checks the webcam image of the bed against a refrence image where the bed is clear.</p>
<p>If you install BedReady, you can add an automated check that the bed is clear for the next print by adding <code>@BEDREADY</code> onto the end of your bed clearing script.</p>
<h2 id="preprocessors">Preprocessors</h2>
<p>You may discover that you want more complex behavior than just running the same script every time an event happens - maybe you want to revert to manual part removal if the print is too small to remove automatically, or you want to sweep prints off in a different direction depending on their material or file name.</p>
<p>This can be done by adding a <strong>Preprocessor</strong>, which is a little bit of extra code that modifies how your GCODE script is executed.</p>
<p>Preprocessors are optionally added to assigned scripts in the <code>Events</code> settings tab. They evaluate based on instantaneous state details, print file metadata, and optional externally provided state.</p>
<h3 id="language">Language</h3>
<p>Preprocessors are evaluated using <a href="https://newville.github.io/asteval/">ASTEVAL</a> which is a <a href="https://www.python.org/">Python</a>-like interpreter. Most simple Python scripts will run just fine.</p>
<p>If you're new to writing Python code and the examples in <code>Settings &gt; Continuous Print &gt; Scripts</code> don't have the answers you need, check out <a href="https://wiki.python.org/moin/BeginnersGuide">here</a> for language resources, or open a new <a href="https://github.com/smartin015/continuousprint/discussions">discussion on GitHub</a>.</p>
<h3 id="return-value">Return Value</h3>
<p>The final line of a preprocessor is used to modify the behavior of the GCODE script:</p>
<ul>
<li><strong>If the last line evaluates to <code>True</code> or <code>False</code></strong>, then it either runs or supresses the script, respectively.</li>
<li><strong>If the last line evaluates to <code>None</code></strong>, then it suppresses the script.</li>
<li><strong>If the last line evalutes to a <code>dict</code> object</strong>, then the items are injected into the GCODE script (they're treated as keyword arguments in a call to <a href="https://docs.python.org/3/tutorial/inputoutput.html#the-string-format-method">format()</a>)</li>
</ul>
<p>To clarify that last option, if you have a GCODE script that looks like:</p>
<pre><code>G0 X{move_dist}
</code></pre>
<p>And you have a preprocessor that looks like:</p>
<pre><code>dict(move_dist = 10 if current['path'].endswith(&quot;_right.gcode&quot;) else -10)
</code></pre>
<p>Then the printer will receive <code>G0 X10</code> for files named e.g. <code>file_right.gcode</code> and <code>G0 X-10</code> for all other files.</p>
<h3 id="notifications">Notifications</h3>
<p>If you want to display any output from running your script, use the <code>print()</code> function like so:</p>
<pre><code>print(&quot;Hello there!&quot;)
</code></pre>
<p>This will cause a status message to pop up with your printed message displayed. Multiple calls to <code>print</code> will be concatenated and shown in a single message.</p>
<h3 id="examples">Examples</h3>
<p>For more examples, see the default preprocessors and scripts in <code>Settings &gt; Continuous Print &gt; Scripts &amp; Preprocessors</code> within OctoPrint. You can also browse <a href="https://github.com/smartin015/continuousprint/blob/master/continuousprint/data/preprocessors.yaml">this YAML file</a> which is the source of those entries.</p>
<h3 id="available-state">Available State</h3>
<p>When you write a Preprocessor, you will reference external information in your expression in order to return a boolean result. This is done by accessing <code>State</code> variables (referred to in <a href="https://newville.github.io/asteval/">ASTEVAL docs</a> as the "symbol table").</p>
<p>Here's an example of what you can expect for state variables:</p>
<pre><code>current: {
    'path': 'testprint.gcode',
    'materials': ['PLA_red_#ff0000'],
    'bed_temp': 23.59,
    'state': '_state_printing',
    'action': 'SUCCESS',
}
external: {&lt;user provided&gt;}
metadata: {
    'hash': '38eea2d4463053bd79af52c3fadc37deaa7bfff7',
    'analysis': {
        'printingArea': {'maxX': 5.3, 'maxY': 7.65, 'maxZ': 19.7, 'minX': -5.3, 'minY': -8.5608, 'minZ': 0.0},
        'dimensions': {'depth': 16.2108, 'height': 19.7, 'width': 10.6},
        'estimatedPrintTime': 713.6694555778557,
        'filament': {'tool0': {'length': 311.02239999999875, 'volume': 0.0}}
    },
    'continuousprint': {
        'profile': 'Monoprice Mini Delta V2'
    },
    'history': [
        {
          'timestamp': 1660053581.8503253,
          'printTime': 109.47731690102955,
          'success': True,
          'printerProfile': '_default'
        },
    ],
    'statistics': {
        'averagePrintTime': {'_default': 113.51082421375965},
        'lastPrintTime': {'_default': 306.7005050050211}
    }
}
</code></pre>
<p>Note that all variables in <code>current</code> (such as <code>path</code>, <code>materials</code>, and <code>bed_temp</code>) are all instantaneous variables about the current state, while <code>metadata</code> comes from file metadata analysis and is absent if <code>path</code> is None or empty.</p>
<p>See also <code>update_interpreter_symbols</code> in <a href="https://github.com/smartin015/continuousprint/blob/master/continuousprint/driver.py">driver.py</a> for how state is constructed and sent to the interpreter.</p>
<h3 id="state-carryover">State Carryover</h3>
<p>Any variable that you set when running a Preprocessor will also be made available to preprocessors that run after on the same event.</p>
<h3 id="external-state">External State</h3>
<p>The <code>external</code> section of the state example above is where you'll find any custom data you inject via POST request to <code>/automation/external</code> - see the <a href="/api/#inject-external-data-into-preprocessor-state">API docs</a> for details.</p>
<p>External data can come from anywhere that can reach your OctoPrint instance on the network - microservices, CRON jobs, IOT and other embedded systems, etc. However, ASTEVAL disables many of the more complex features of Python for security reasons. For this reason, you may want to do heavy processing (e.g. image or video segmentation, object detection, point cloud processing) elsewhere and then push only the information needed to format the event script.</p>
<h2 id="contributing">Contributing</h2>
<p>When you come up with a useful script for e.g. clearing the print bed, consider contributing it back to the community!</p>
<ol>
<li>Visit <a href="https://github.com/smartin015/continuousprint">the repository</a> and click the "Fork" button on the top right to create a fork.</li>
<li>Go to <a href="https://github.com/smartin015/continuousprint/tree/rc/continuousprint/data/printer_profiles.yaml">printer_profiles.yaml</a> and check to see if your printer make and model are present. If they aren't, click the pencil icon on the top right of the file to begin editing.</li>
<li>When you're done adding details, save it to a new branch of your fork.</li>
<li>Now go to <a href="https://github.com/smartin015/continuousprint/tree/rc/continuousprint/data/gcode_scripts.yaml">gcode_scripts.yaml</a> and edit it in the same way, adding your gcode and any additional fields.</li>
<li>Do the same for any new preprocessors with <a href="https://github.com/smartin015/continuousprint/tree/rc/continuousprint/data/preprocessors.yaml">preprocessors.yaml</a>.</li>
<li>Save your changes - to a new branch if you didn't have to do anything on step 2, otherwise to the same branch you created earlier.</li>
<li>Check one last time that the script names match those provided in your printer profiles <code>defaults</code> section, then submit a pull request. <strong>Make sure to do a PR against the <code>rc</code> branch, NOT the <code>master</code> branch.</strong></li>
</ol>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../getting-started/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Getting Started" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Getting Started
            </div>
          </div>
        </a>
      
      
        
        <a href="../advanced-queuing/" class="md-footer__link md-footer__link--next" aria-label="Next: Queuing Basics" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Queuing Basics
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>